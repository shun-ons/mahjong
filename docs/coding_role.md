# **コーディング規約**

## **1. はじめに (Introduction)**

このドキュメントは、本プロジェクトにおけるPythonコードの品質と一貫性を保つためのコーディング規約を定めたものです。コードを記述する際は、原則としてこの規約に従ってください。

この規約の目的は以下の通りです。

- **可読性の向上:** 誰が読んでも理解しやすいコードを目指します。
- **メンテナンス性の確保:** 将来の修正や機能追加を容易にします。
- **バグの抑制:** 一貫したスタイルを保つことで、潜在的なバグを減らします。

基本的な思想は、Pythonの公式スタイルガイドである **PEP 8** に準拠します。

-----

## **2. 命名規則 (Naming Conventions)**

命名は、その変数や関数が「何であるか」を明確に表現する、分かりやすい英単語を用いてください。意味のない安易な名前 (`a`, `b`, `tmp` など) は、一時的なループ変数などを除き、極力避けてください。

| 対象 | 命名規則 | 例 |
|:--- |:--- |:--- |
| **変数** | スネークケース (`snake_case`) | `user_name`, `current_hand` |
| **定数** | アッパースネークケース (`UPPER_SNAKE_CASE`) | `MAX_PLAYERS`, `DEFAULT_SCORE` |
| **クラス** | キャメルケース (CapWords) | `MahjongHand`, `ScoreCalculator` |
| **関数・メソッド** | スネークケース (`snake_case`) | `calculate_score`, `get_user_data` |
| **ファイル・モジュール** | スネークケース (`snake_case`) | `score_calculator.py`, `tile_detector.py` |

### **Boolean型の変数・関数**

真偽値（`True`/`False`）を扱う変数や関数の名前は、`is_` や `has_` で始めることで、それがBooleanであることを明確に示してください。

- `is_ready`
- `has_permissions`

-----

## **3. ドキュメンテーション (Documentation)**

コードの意図を明確に伝えるため、ドキュメンテーションを必ず記述します。

### **Docstring（ドキュメンテーション文字列）**

すべての**関数**、**メソッド**、**クラス**、**モジュール**の先頭には、その役割を説明するDocstringを記述してください。Docstringは、トリプルクォート (`"""..."""`) で囲みます。

**形式 (Google Python Style Guide推奨):**

```python
def calculate_score(hand: list[str], game_info: dict) -> dict:
    """あがり手と対局情報から点数を計算する。

    Args:
        hand: 牌の文字列リスト。例: ['1m', '2m', '3m']
        game_info: 対局情報を含む辞書。

    Returns:
        計算結果を含む辞書。役、符、点数などが含まれる。

    Raises:
        ValueError: 手牌の形式が不正な場合に送出される。
    """
    # ... 関数の処理 ...
```

#### **Docstringの自動挿入方法**

VScodeの拡張機能を用いれば、トリプルクォーテーションを入力するだけで自動でフォーマットを作成してくれます。
[こちらを参考にして導入してください。](https://qiita.com/Jazuma/items/214ebd89cb3954aba454)

-----

## **4. 型ヒント (Type Hinting)**

コードの堅牢性と可読性を高めるため、**型ヒント**を必ず使用してください。

- **関数の引数と返り値**には、必ず型ヒントを付けます。
- Python 3.9以降では、`list`や`dict`などの標準コレクションをそのまま型ヒントとして使用できます。

<!-- end list -->

```python
# 良い例
def get_user_name(user_id: int) -> str:
    # ...

# 悪い例 (型ヒントがない)
def get_user_name(user_id):
    # ...
```

-----

## **5. コードのフォーマット (Code Formatting)**

一貫したフォーマットは、コードの可読性を大きく向上させます。

- **インデント:** 半角スペース **4つ** を使用します。（タブは使用しない）
- **1行の長さ:** 原則として **79文字** を上限とします。
  - 長い行は、括弧 `()` やバックスラッシュ `\` を使って適切に改行してください。
- **空行:**
  - トップレベルの関数やクラス定義の間は、**2行**の空行を入れます。
  - クラス内のメソッド定義の間は、**1行**の空行を入れます。
- **演算子の前後:** `+`, `-`, `*`, `/`, `=`, `==` などの二項演算子の前後には、半角スペースを1つ入れます。
  - `x = y + 1`
- **カンマの後:** カンマの後には、半角スペースを1つ入れます。
  - `[1, 2, 3]`

### **自動フォーマッタの利用**

コードのフォーマットを自動化するため、**Black** や **autopep8** などのツールを利用することを強く推奨します。これにより、手作業でのフォーマットの手間を省き、プロジェクト全体で一貫したスタイルを保つことができます。
[Blackの導入方法はこちらから](https://maku.blog/p/4oybku6/)
